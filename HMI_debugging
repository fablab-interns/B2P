#define MotFwd  19  // Motor Forward pin
#define MotRev  21  // Motor Reverse pin

#define ButtonInc  32  // Increment button pin
#define ButtonDec  33  // Decrement button pin

int lastButtonIncState = HIGH;  // Previous state of increment button
int lastButtonDecState = HIGH;  // Previous state of decrement button

unsigned long lastDebounceTimeInc = 0;  // Last debounce time for increment button
unsigned long lastDebounceTimeDec = 0;  // Last debounce time for decrement button
unsigned long debounceDelay = 50;  // Debounce delay (in milliseconds)

void setup() {
  pinMode(MotFwd, OUTPUT); 
  pinMode(MotRev, OUTPUT); 
  Serial.begin(9600); // Initialize serial communication

  pinMode(ButtonInc, INPUT_PULLUP);  // Set increment button pin as input with pull-up resistor
  pinMode(ButtonDec, INPUT_PULLUP);  // Set decrement button pin as input with pull-up resistor

  // Initially, motor should be off
  digitalWrite(MotFwd, LOW);
  digitalWrite(MotRev, LOW);
}

void loop() {
  // Read the state of the increment button
  int readingInc = digitalRead(ButtonInc);

  // Check if the increment button has been pressed (LOW because of INPUT_PULLUP)
  if (readingInc == LOW && lastButtonIncState == HIGH && (millis() - lastDebounceTimeInc) > debounceDelay) {
    moveForward();  // Move forward for a certain amount of time
    lastDebounceTimeInc = millis();  // Record the time of the press
  }

  // Read the state of the decrement button
  int readingDec = digitalRead(ButtonDec);

  // Check if the decrement button has been pressed (LOW because of INPUT_PULLUP)
  if (readingDec == LOW && lastButtonDecState == HIGH && (millis() - lastDebounceTimeDec) > debounceDelay) {
    moveBackward();  // Move backward for a certain amount of time
    lastDebounceTimeDec = millis();  // Record the time of the press
  }

  // Store the current button states for the next loop iteration
  lastButtonIncState = readingInc;
  lastButtonDecState = readingDec;

  // Print motor status for debugging
  Serial.print("Motor is: ");
  if (digitalRead(MotFwd) == HIGH) {
    Serial.println("Forward");
  } else if (digitalRead(MotRev) == HIGH) {
    Serial.println("Reverse");
  } else {
    Serial.println("Stopped");
  }

  delay(100); // Small delay for stability
}

// Move motor forward for a set time (adjust the time to control distance)
void moveForward() {
  Serial.println("Moving Forward");
  digitalWrite(MotFwd, HIGH);  // Turn motor forward
  digitalWrite(MotRev, LOW);   // Ensure reverse is off

  delay(1000);  // Move forward for 1 second (adjust this as needed)
  
  digitalWrite(MotFwd, LOW);   // Stop the motor
  Serial.println("Motor Stopped after Moving Forward");
}

// Move motor backward for a set time (adjust the time to control distance)
void moveBackward() {
  Serial.println("Moving Backward");
  digitalWrite(MotFwd, LOW);   // Ensure forward is off
  digitalWrite(MotRev, HIGH);  // Turn motor in reverse

  delay(1000);  // Move backward for 1 second (adjust this as needed)
  
  digitalWrite(MotRev, LOW);   // Stop the motor
  Serial.println("Motor Stopped after Moving Backward");
}
